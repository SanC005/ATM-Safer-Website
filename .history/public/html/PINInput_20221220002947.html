<!DOCTYPE html>
<html>
<head>
    
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
</head>

<style>
.PINtext {
	font-size:40px;
	width: 300px;
	text-align: center;
}
.calcBtn {
	font-size: 30px;
	width: 100px;
    height: 100px;
    margin: 10px;

}
</style>

<body>
<div class="container">

<div class="row">
    <h2 style="text-align: center">Please enter your PIN: </h2>
</div>
<form action="/PINinput" method="POST">
<p align="center"><input  id="tbInput" class="PINtext" type="password" placeholder="Enter PIN" maxlength="4"/></p>
</form>
<div id="VirtualKey" align="center">
    <input class="calcBtn" id="btn1" type="button" onclick="input(this.value);" value="1" />
    <input class="calcBtn" id="btn2" type="button" onclick="input(this.value);" value="2" />
    <input class="calcBtn" id="btn3" type="button" onclick="input(this.value);" 
    value="3"/>
    <br />
    <input class="calcBtn" id="btn4" type="button" onclick="input(this.value);" 
    value="4"/>
    <input class="calcBtn" id="btn5" type="button" onclick="input(this.value);" 
    value="5"/>
    <input class="calcBtn" id="btn6" type="button" onclick="input(this.value);" 
    value="6"/>
    <br />
    <input class="calcBtn" id="btn7" type="button" onclick="input(this.value);" 
    value="7"/>
    <input class="calcBtn" id="btn8" type="button" onclick="input(this.value);" 
    value="8"/>
    <input class="calcBtn" id="btn9" type="button" onclick="input(this.value);" 
    value="9"/>
    <br />
    <input class="calcBtn" id="btnEnt" type="button" onclick="ent()" style="color:green" 
    value="Enter"/>
    <input class="calcBtn" id="btn0" type="button" onclick="input(this.value);" 
    value="0"/>
    <input class="calcBtn" id="btnDel" type="button" style="color:red" value="Delete" onclick="del();" />
</div>

<span id="PIN"></span>
    <div class="row">
        <div class="col-md-4"></div>
        <div class="col-md-4"></div>
        <div class="col-md-4"><a href="index.html"  class="btn btn-danger btn-lg returnCardButton">Return Card</a></div>
    </div>
<script>

    var nonChar = "" 
window.onload=init;         
function init()   {
  console.log("init");
    var char = "0123456789";
    keyValue = "";
    for (i=0 ; keyValue.length < 10; i++){
        rand = Math.round(Math.random()*10);
        if(keyValue.indexOf(rand)>-1) continue;
        keyValue += char.substring(rand, rand+1);
        }
      console.log(keyValue);
    counter = 0;
    while(counter < 10){
    
    document.querySelector("#btn"+counter).value = keyValue[counter];
    counter++
    }
  
 }  
function input(button){
  console.log(button);
    clickedButton(button);
 }   
          
/*
function deleteChar(){
    clickedButton(nonChar = nonChar.substring(0,nonChar.length-1))
}   */     
          
function clickedButton(e){
  var tbInput = document.getElementById("tbInput");
  console.log("clicked is "+ e + " " + tbInput.value);
  if (tbInput.value.length < 4) {
  tbInput.value= tbInput.value + e;
  }
} 


function del() {
	var tbInput = document.getElementById("tbInput");
	tbInput.value = tbInput.value.substr(0, tbInput.value.length-1);
}
var count=1;
function ent() {
	var PIN="1234";
    var PIN2="1111";
  	var str1=document.getElementById("tbInput").value;
  	if (str1==PIN || str1==PIN2)
  	{
  		window.location="selectAcct.html";
 	}
 	else{
 		if (count<3){
 		alert("Incorrect PIN.  You have "+(3-count)+" attempts left");
 		document.getElementById("tbInput").value ="";
 		count++;
 		}
 		else{
 				alert("Incorrect PIN limit reached.\nYour card has been frozen.\nPlease contact your bank.");
 				window.location="invalid.html";
 		}
 	}
}
//$("#PIN").append('<p align="center"> ***The PIN is '+ getPIN()+ '***</p>')

</script>
</div>

<script src"../jq/jquery.js" type="text/javascript"></script>
    <script src"../js/bootstrap.js" type="text/javascript"></script>
</body>
</html>